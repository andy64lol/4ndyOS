<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4ndyOS NeoM4trix</title>
    <style>
        body{background:#1e1e1e;margin:0;height:100vh;display:flex;justify-content:center;align-items:center;font-family:'Courier New';overflow:hidden;}
        .terminal{background:#2d2d2d;width:80%;max-width:800px;border-radius:5px;box-shadow:0 0 10px rgba(0,0,0,0.5);position:relative;z-index:1000;}
        .title-bar{background:#3d3d3d;padding:10px;border-radius:5px 5px 0 0;display:flex;align-items:center;}
        .buttons{display:flex;gap:8px;}
        .button{width:12px;height:12px;border-radius:50%;}
        .close{background:#ff5f56;}
        .minimize{background:#ffbd2e;}
        .maximize{background:#27c93f;}
        .title{color:#b3b3b3;font-size:14px;margin-left:10px;}
        .content{padding:20px;color:#fff;height:400px;display:flex;flex-direction:column;}
        #output{flex:1;overflow-y:auto;margin-bottom:10px;}
        .input-line{display:flex;align-items:center;gap:10px;}
        .prompt{color:#27c93f;}
        #command-input{background:transparent;border:none;color:#fff;font-family:'Courier New';font-size:16px;width:100%;caret-color:#fff;outline:none;}
        .app-window{position:fixed;background:#2d2d2d;border-radius:5px;box-shadow:0 0 15px rgba(0,0,0,0.3);width:600px;height:400px;display:flex;flex-direction:column;resize:both;overflow:hidden;min-width:300px;min-height:200px;}
        .window-header{background:#3d3d3d;padding:10px;display:flex;justify-content:space-between;align-items:center;cursor:move;}
        .window-title{color:#fff;font-size:14px;}
        .window-controls{display:flex;gap:8px;}
        .window-button{width:12px;height:12px;border-radius:50%;cursor:pointer;transition:transform 0.2s;}
        .window-button:hover{transform:scale(1.1);}
        .window-close{background:#ff5f56;}
        .window-minimize{background:#ffbd2e;}
        .window-maximize{background:#27c93f;}
        .app-frame{flex:1;border:none;background:#1e1e1e;}
        .shutdown-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;display:none;justify-content:center;align-items:center;color:#0f0;z-index:9999;}
        .shutdown-message{animation:scanline 2s infinite;text-align:center;}
        @keyframes scanline{0%{opacity:0.8;}50%{opacity:0.2;}100%{opacity:0.8;}}
    </style>
</head>
<body>
    <div class="shutdown-screen" id="shutdownScreen">
        <div class="shutdown-message">
            <h1>4ndyOS NeoM4trix</h1>
            <p>System shutdown complete</p>
            <p>> Press any key to reboot</p>
        </div>
    </div>
    <div class="terminal">
        <div class="title-bar">
            <div class="buttons">
                <div class="button close"></div>
                <div class="button minimize"></div>
                <div class="button maximize"></div>
            </div>
            <div class="title">4ndyOS NeoM4trix Terminal</div>
        </div>
        <div class="content">
            <div id="output"></div>
            <div class="input-line">
                <span class="prompt">$</span>
                <input type="text" id="command-input" autofocus>
            </div>
        </div>
    </div>
    <script>
        const input=document.getElementById('command-input'),output=document.getElementById('output');
        let commandHistory=[],historyPosition=0,apps=[],zIndex=1000;
        
        function shutdownSystem(){
            document.querySelectorAll('.app-window').forEach(w=>w.remove());
            document.getElementById('shutdownScreen').style.display='flex';
            output.innerHTML='';
            addOutput('System shutdown initiated...');
            document.addEventListener('keydown',handleReboot);
        }
        
        function handleReboot(){
            document.getElementById('shutdownScreen').style.display='none';
            output.innerHTML='';
            commandHistory=[];
            historyPosition=0;
            input.value='';
            loadApps();
            addOutput('4ndyOS NeoM4trix v2.0 - Type \'help\' for commands');
        }
        
        function loadApps(){
            fetch('NeoM4trixApps/apps.json')
            .then(r=>r.json())
            .then(d=>{apps=d;addOutput('System apps loaded: '+d.map(a=>a.name).join(', '))})
            .catch(e=>addOutput('Failed to load apps: '+e.message));
        }
        
        function executeCommand(c){
            const[cmd,...args]=c.trim().split(' '),app=apps.find(a=>a.command===cmd.toLowerCase());
            if(app){createAppWindow(app);return `${app.name} initialized...`;}
            switch(cmd.toLowerCase()){
                case'help':return `Available apps:\n${apps.map(a=>`- ${a.command}: ${a.description}`).join('\n')}\n\nSystem commands:\n- help\n- clear\n- shutdown\n- reboot\n- echo\n- date\n- about`;
                case'clear':output.innerHTML='';return'';
                case'date':return new Date().toString();
                case'about':return '4ndyOS NeoM4trix v2.0\nNeoKernel 5.1\nQuantum Matrix 2.0';
                case'echo':return args.join(' ');
                case'shutdown':case'poweroff':case'turnoff':shutdownSystem();return'';
                case'reboot':handleReboot();return'';
                default:return `Command not found: ${c}`;
            }
        }
        
        function createAppWindow(a){
            const wId=`window-${Date.now()}`;
            document.body.insertAdjacentHTML('beforeend',`
                <div class="app-window" id="${wId}" style="z-index:${zIndex++}">
                    <div class="window-header">
                        <div class="window-title">${a.name}</div>
                        <div class="window-controls">
                            <div class="window-button window-minimize" onclick="toggleWindow('${wId}')"></div>
                            <div class="window-button window-maximize" onclick="maximizeWindow('${wId}')"></div>
                            <div class="window-button window-close" onclick="closeWindow('${wId}')"></div>
                        </div>
                    </div>
                    <iframe class="app-frame" src="${a.path}"></iframe>
                </div>`);
            makeDraggable(wId);
            centerWindow(wId);
        }
        
        function closeWindow(w){document.getElementById(w)?.remove();}
        function toggleWindow(w){const e=document.getElementById(w);e.style.display=e.style.display==='none'?'flex':'none';}
        function maximizeWindow(w){
            const e=document.getElementById(w);
            if(e.classList.contains('maximized')){
                e.classList.remove('maximized');
                e.style.width='600px';
                e.style.height='400px';
            }else{
                e.classList.add('maximized');
                e.style.width='96vw';
                e.style.height='90vh';
            }
            centerWindow(w);
        }
        function centerWindow(w){
            const e=document.getElementById(w);
            if(!e.classList.contains('maximized')){
                e.style.left='calc(50% - 300px)';
                e.style.top='calc(50% - 200px)';
            }
        }
        
        function makeDraggable(w){
            const windowEl=document.getElementById(w);
            const header=windowEl.querySelector('.window-header');
            let isDragging=false,offset=[0,0];
            
            header.addEventListener('mousedown',e=>{
                isDragging=true;
                offset=[
                    windowEl.offsetLeft - e.clientX,
                    windowEl.offsetTop - e.clientY
                ];
            });
            
            document.addEventListener('mousemove',e=>{
                e.preventDefault();
                if(isDragging){
                    windowEl.style.left=(e.clientX + offset[0])+'px';
                    windowEl.style.top=(e.clientY + offset[1])+'px';
                }
            });
            
            document.addEventListener('mouseup',()=>isDragging=false);
        }
        
        function addCommand(c){const d=document.createElement('div');d.className='command';d.innerHTML=`<span class="prompt">$</span> ${c}`;output.appendChild(d);}
        function addOutput(t){if(!t)return;const d=document.createElement('div');d.className='output-text';d.textContent=t;output.appendChild(d);}
        
        function processCommand(c){
            if(!c.trim())return;
            commandHistory.push(c);
            historyPosition=0;
            addCommand(c);
            const r=executeCommand(c);
            addOutput(r);
            input.value='';
            output.scrollTop=output.scrollHeight;
        }
        
        function handleKeyDown(e){
            switch(e.key){
                case'Enter':processCommand(input.value);break;
                case'ArrowUp':historyPosition=Math.max(0,Math.min(commandHistory.length,historyPosition-1));input.value=commandHistory[commandHistory.length-historyPosition]||'';e.preventDefault();break;
                case'ArrowDown':historyPosition=Math.max(0,Math.min(commandHistory.length,historyPosition+1));input.value=commandHistory[commandHistory.length-historyPosition]||'';e.preventDefault();break;
            }
        }
        
        loadApps();
        addOutput('4ndyOS NeoM4trix v2.0 - Type \'help\' for commands');
        input.addEventListener('keydown',handleKeyDown);
    </script>
</body>
</html>
